cd /home/alex/WinTin

# Check that we have a supported TMUX version
tmux -V | grep 3.4
if [[ $(echo $?) != 0 ]]; then
    echo -e "Script only supports TMUX 3.4\n"
    exit 1
fi

# Kill all prior sessions
tmux ls | grep discworld
if [[ $(echo $?) == 0 ]]; then
    tmux kill-session -t discworld
fi

tmux new-session -d -A -D -s discworld

# Create death timer window
tmux select-pane -t discworld:0.0
tmux split-window -h -l 15
tmux send-keys -t discworld:0.1 './bin/dt' 'C-m'

# Create chat window
tmux select-pane -t discworld:0.1
tmux split-window -v
tmux send-keys -t discworld:0.2 'clear && tail -fs .5 logs/chat.log' 'C-m'

# Create map window
tmux select-pane -t discworld:0.2
tmux split-window -v
tmux send-keys -t discworld:0.3 './bin/map' 'C-m'

# Create map door text parsing window
tmux select-pane -t discworld:0.0
tmux split-window -v -l 30
tmux send-keys -t discworld:0.0 './bin/mdt' 'C-m'

# Run main window
tmux select-pane -t discworld:0.1
tmux attach-session -t discworld -d